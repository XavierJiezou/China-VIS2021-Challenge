# 【Python】调用高德地图 API 实现逆地理编码

## 简介

逆地理编码：将经纬度转换为详细结构化的地址，且返回附近周边的 POI、AOI 信息。例如：116.480881,39.989410 转换地址描述后：北京市朝阳区阜通东大街 6 号。

## 安装

```bash
pip install requests
```

## 用法

## 请求说明

- 请求地址

> https://restapi.amap.com/v3/geocode/regeo

- 请求方式

`GET`

- 请求参数

| 参数名   | 含义             | 规则说明                                                                                                                                                                                                                       | 是否必须 | 缺省值 |
| -------- | ---------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | -------- | ------ |
| key      | 高德 key         | 用户在高德地图官网[申请 Web 服务 API 类型 key](https://lbs.amap.com/dev/)                                                                                                                                                      | 必填     | 无     |
| location | 经纬度坐标       | 传入内容规则：经度在前，纬度在后，经纬度间以“,”分割，经纬度小数点后不要超过 6 位。如果需要解析多个经纬度的话，请用" &vert; "进行间隔，并且将 batch 参数设置为 true，最多支持传入 20 对坐标点。每对点坐标之间用" &vert; "分割。 | 必填     | 无     |
| batch    | 批量查询控制     | batch 参数设置为 true 时进行批量查询操作，最多支持 20 个经纬度点进行批量地址查询操作。<br>batch 参数设置为 false 时进行单点查询，此时即使传入多个经纬度也只返回第一个经纬度的地址解析查询结果。                                | 可选     | false  |
| output   | 返回数据格式类型 | 可选输入内容包括：JSON，XML。设置 JSON 返回结果数据将会以 JSON 结构构成；如果设置 XML 返回结果数据将以 XML 结构构成。                                                                                                          | 可选     | JSON   |

## 响应结果

| 名称       | 含义           | 规则说明                                                                                                                                                                      |
| ---------- | -------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| status     | 返回结果状态值 | 返回值为 0 或 1，0 表示请求失败；1 表示请求成功。                                                                                                                             |
| info       | 返回状态说明   | 当 status 为 0 时，info 会返回具体错误原因，否则返回“OK”。详情可以参考：[info 状态表](https://lbs.amap.com/api/webservice/guide/tools/info) 。                                |
| regeocodes | 逆地理编码列表 | batch 字段设置为 true 时为批量请求，此时 regeocodes 标签返回，标签下为 regeocode 对象列表；batch 为 false 时为单个请求，会返回 regeocode 对象；regeocode 对象包含的数据如下。 |

- formatted_address | 结构化地址信息 | 结构化地址信息包括：省份＋城市＋区县＋城镇＋乡村＋街道＋门牌号码。如果坐标点处于海域范围内，则结构化地址信息为：省份＋城市＋区县＋海域信息
- addressComponent | 地址元素列表
  - province | 坐标点所在省名称 | 例如：北京市
  - city | 坐标点所在城市名称 | 请注意：当城市是省直辖县时返回为空，以及城市为北京、上海、天津、重庆四个直辖市时，该字段返回为空；[省直辖县列表](https://lbs.amap.com/faq/webservice/webservice-api/geocoding/43267)
  - citycode | 城市编码 | 例如：010
  - district | 坐标点所在区 | 例如：海淀区
  - adcode | 行政区编码 | 例如：110108
  - ……

### 成功示例

```plainText
https://restapi.amap.com/v3/geocode/regeo?key=您的key&location=116.481488,39.990464&poitype=商务写字楼&radius=1000&extensions=base&batch=false&roadlevel=0
```

```json
{
    "status": "1",
    "info": "OK",
    "infocode": "10000",
    "regeocode": {
        "formatted_address": "北京市朝阳区望京街道方恒国际中心B座方恒国际",
        "addressComponent": {
            "country": "中国",
            "province": "北京市",
            "city": [],
            "citycode": "010",
            "district": "朝阳区",
            "adcode": "110105",
            "township": "望京街道",
            "towncode": "110105026000",
            "neighborhood": { …},
            "building": { …},
            "streetNumber": { …},
            "businessAreas": [ …]
        }
    }
}
```

## 拓展

| 匹配级别         | 示例说明                       |
| ---------------- | ------------------------------ |
| 国家             | 中国                           |
| 省               | 河北省、北京市                 |
| 市               | 宁波市                         |
| 区县             | 北京市朝阳区                   |
| 开发区           | 亦庄经济开发区                 |
| 乡镇             | 回龙观镇                       |
| 村庄             | 三元村                         |
| 热点商圈         | 上海市黄浦区老西门             |
| 兴趣点           | 北京市朝阳区奥林匹克公园(南门) |
| 门牌号           | 朝阳区阜通东大街 6 号          |
| 单元号           | 望京西园四区 5 号楼 2 单元     |
| 道路             | 北京市朝阳区阜通东大街         |
| 道路交叉路口     | 北四环西路辅路/善缘街          |
| 公交站台、地铁站 | 海淀黄庄站 A1 西北口           |
| 未知             | 未确认级别的 POI               |

## 参考

> [高德地图 API > Web 服务 API > 开发指南 > API 文档 > 逆地理编码](https://lbs.amap.com/api/webservice/guide/api/georegeo/#regeo)
